<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sudoku avec reconnaissance MNIST</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: white;
        }

        .app-container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }

        .app-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .app-header h1 {
            font-size: 2.5em;
            color: #ffd700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 10px;
        }

        .app-header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .main-layout {
            display: grid;
            grid-template-columns: 1fr 420px;
            gap: 30px;
            align-items: start;
        }

        /* SUDOKU SECTION */
        .sudoku-section {
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 15px;
            backdrop-filter: blur(5px);
        }

        .sudoku-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .sudoku-grid {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            gap: 2px;
            background: #333;
            padding: 10px;
            border-radius: 10px;
            max-width: 450px;
            margin: 0 auto;
        }

        .sudoku-cell {
            width: 45px;
            height: 45px;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: bold;
            color: #333;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 3px;
            position: relative;
        }

        .sudoku-cell:hover {
            background: #ffd700;
            transform: scale(1.05);
        }

        .sudoku-cell.selected {
            background: #87CEEB;
            box-shadow: 0 0 10px rgba(135, 206, 235, 0.7);
        }

        .sudoku-cell.empty {
            background: #f8f8f8;
            color: #999;
        }

        .sudoku-cell.empty:hover {
            background: #e0e0e0;
        }

        .sudoku-cell.fixed {
            background: #e6e6e6;
            color: #666;
            cursor: not-allowed;
        }

        .sudoku-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(45deg, #74b9ff, #0984e3);
            color: white;
        }

        .btn-success {
            background: linear-gradient(45deg, #00b894, #00a085);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        /* MNIST SECTION */
        .mnist-section {
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 15px;
            backdrop-filter: blur(5px);
            height: fit-content;
        }

        .mnist-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .mnist-header h2 {
            color: #ffd700;
            margin-bottom: 10px;
        }

        .mnist-status {
            background: rgba(0, 255, 0, 0.2);
            border: 1px solid rgba(0, 255, 0, 0.5);
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
            font-size: 14px;
        }

        .mnist-iframe-container {
            position: relative;
            border: 3px solid #ffd700;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(255, 215, 0, 0.3);
        }

        #mnistFrame {
            width: 100%;
            height: 500px;
            border: none;
            display: block;
        }

        .mnist-instructions {
            background: rgba(255, 165, 0, 0.2);
            border: 1px solid rgba(255, 165, 0, 0.5);
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-size: 14px;
            line-height: 1.5;
        }

        .usage-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #ffd700;
            display: block;
        }

        .stat-label {
            font-size: 12px;
            opacity: 0.8;
            margin-top: 5px;
        }

        /* RESPONSIVE */
        @media (max-width: 1200px) {
            .main-layout {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .mnist-section {
                order: -1;
            }

            .sudoku-grid {
                max-width: 100%;
            }

            .sudoku-cell {
                width: calc((100vw - 120px) / 9);
                height: calc((100vw - 120px) / 9);
                max-width: 45px;
                max-height: 45px;
            }
        }

        @media (max-width: 768px) {
            .app-container {
                padding: 15px;
            }

            .app-header h1 {
                font-size: 2em;
            }

            .sudoku-cell {
                font-size: 14px;
            }

            #mnistFrame {
                height: 400px;
            }

            .sudoku-controls {
                gap: 10px;
            }

            .btn {
                padding: 10px 20px;
                font-size: 14px;
            }
        }

        /* ANIMATIONS */
        @keyframes cellFill {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); background: #90EE90; }
            100% { transform: scale(1); }
        }

        .sudoku-cell.filled {
            animation: cellFill 0.5s ease;
        }

        .loading {
            text-align: center;
            padding: 20px;
            opacity: 0.7;
        }

        /* MODAL STYLES */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 5% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            text-align: center;
            color: white;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: #fff;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="app-header">
            <h1>üß© Sudoku avec IA MNIST</h1>
            <p>R√©solvez votre Sudoku en dessinant les chiffres √† la main !</p>
        </div>

        <div class="main-layout">
            <!-- SECTION SUDOKU -->
            <div class="sudoku-section">
                <div class="sudoku-header">
                    <h2>üéØ Grille Sudoku</h2>
                    <div class="usage-stats">
                        <div class="stat-card">
                            <span class="stat-value" id="cellsCompleted">0</span>
                            <span class="stat-label">Cellules remplies</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-value" id="mnistUsed">0</span>
                            <span class="stat-label">Chiffres reconnus</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-value" id="gameProgress">0%</span>
                            <span class="stat-label">Progression</span>
                        </div>
                    </div>
                </div>

                <div class="sudoku-grid" id="sudokuGrid">
                    <!-- Les cellules seront g√©n√©r√©es par JavaScript -->
                </div>

                <div class="sudoku-controls">
                    <button class="btn btn-secondary" onclick="newGame()">üé≤ Nouvelle partie</button>
                    <button class="btn btn-primary" onclick="clearGrid()">üóëÔ∏è Effacer</button>
                    <button class="btn btn-success" onclick="validateSudoku()">‚úÖ V√©rifier</button>
                    <button class="btn btn-primary" onclick="showInstructions()">‚ùì Aide</button>
                </div>
            </div>

            <!-- SECTION MNIST -->
            <div class="mnist-section">
                <div class="mnist-header">
                    <h2>‚úèÔ∏è Reconnaissance MNIST</h2>
                    <div class="mnist-status">
                        ‚úÖ Site UCSD int√©gr√© - Mod√®le 98.5% de pr√©cision
                    </div>
                </div>

                <div class="mnist-iframe-container">
                    <iframe 
                        id="mnistFrame"
                        src="https://www.ccom.ucsd.edu/~cdeotte/programs/MNIST.html"
                        loading="lazy">
                    </iframe>
                </div>

                <div class="mnist-instructions">
                    <strong>üìù Mode d'emploi :</strong><br>
                    1. Dessinez un chiffre (1-9) dans la zone ci-dessus<br>
                    2. Cliquez "classify" pour obtenir la reconnaissance<br>
                    3. Cliquez sur une cellule Sudoku vide ci-contre<br>
                    4. Entrez le chiffre reconnu manuellement<br><br>
                    <strong>üí° Astuce :</strong> Dessinez clairement au centre !
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL D'INSTRUCTIONS -->
    <div id="instructionsModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2>üéÆ Comment jouer</h2>
            <p><strong>R√®gles du Sudoku :</strong></p>
            <ul style="text-align: left; margin: 20px 0;">
                <li>Remplir une grille 9√ó9 avec les chiffres 1 √† 9</li>
                <li>Chaque ligne doit contenir tous les chiffres 1-9</li>
                <li>Chaque colonne doit contenir tous les chiffres 1-9</li>
                <li>Chaque r√©gion 3√ó3 doit contenir tous les chiffres 1-9</li>
            </ul>
            
            <p><strong>Utilisation de MNIST :</strong></p>
            <ul style="text-align: left; margin: 20px 0;">
                <li>Dessinez votre chiffre dans la zone MNIST</li>
                <li>L'IA va le reconna√Ætre avec 98.5% de pr√©cision</li>
                <li>Utilisez le r√©sultat pour remplir les cellules</li>
                <li>Parfait pour tester la reconnaissance de chiffres !</li>
            </ul>
        </div>
    </div>

    <script>
        // Variables globales
        let selectedCell = null;
        let sudokuGrid = [];
        let completedCells = 0;
        let mnistRecognitions = 0;

        // Grille Sudoku d'exemple (partiellement remplie)
        const initialGrid = [
            [5, 3, 0, 0, 7, 0, 0, 0, 0],
            [6, 0, 0, 1, 9, 5, 0, 0, 0],
            [0, 9, 8, 0, 0, 0, 0, 6, 0],
            [8, 0, 0, 0, 6, 0, 0, 0, 3],
            [4, 0, 0, 8, 0, 3, 0, 0, 1],
            [7, 0, 0, 0, 2, 0, 0, 0, 6],
            [0, 6, 0, 0, 0, 0, 2, 8, 0],
            [0, 0, 0, 4, 1, 9, 0, 0, 5],
            [0, 0, 0, 0, 8, 0, 0, 7, 9]
        ];

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            initializeSudoku();
            updateStats();
            
            // Gestionnaire pour les cellules
            document.addEventListener('keypress', function(e) {
                if (selectedCell && e.key >= '1' && e.key <= '9') {
                    fillCell(selectedCell, e.key);
                }
            });

            // Message de bienvenue
            setTimeout(() => {
                if (confirm("üéâ Bienvenue ! Voulez-vous voir les instructions ?")) {
                    showInstructions();
                }
            }, 1000);
        });

        function initializeSudoku() {
            const grid = document.getElementById('sudokuGrid');
            grid.innerHTML = '';
            sudokuGrid = [];
            completedCells = 0;

            for (let row = 0; row < 9; row++) {
                sudokuGrid[row] = [];
                for (let col = 0; col < 9; col++) {
                    const cell = document.createElement('div');
                    cell.className = 'sudoku-cell';
                    cell.dataset.row = row;
                    cell.dataset.col = col;
                    
                    const value = initialGrid[row][col];
                    if (value !== 0) {
                        cell.textContent = value;
                        cell.classList.add('fixed');
                        sudokuGrid[row][col] = value;
                        completedCells++;
                    } else {
                        cell.classList.add('empty');
                        cell.textContent = '';
                        sudokuGrid[row][col] = 0;
                        
                        // Ajouter un placeholder visuel
                        cell.innerHTML = '<span style="opacity:0.3; font-size:12px;">?</span>';
                    }
                    
                    cell.addEventListener('click', () => selectCell(cell));
                    grid.appendChild(cell);
                }
            }
        }

        function selectCell(cell) {
            if (cell.classList.contains('fixed')) {
                return; // Ne pas s√©lectionner les cellules fixes
            }

            // D√©s√©lectionner la cellule pr√©c√©dente
            if (selectedCell) {
                selectedCell.classList.remove('selected');
            }

            // S√©lectionner la nouvelle cellule
            selectedCell = cell;
            cell.classList.add('selected');

            // Prompt pour entrer le chiffre
            const digit = prompt(`üî¢ Entrez un chiffre (1-9) pour cette cellule :\n\nüí° Conseil : Utilisez la reconnaissance MNIST ci-contre pour dessiner votre chiffre !`);
            
            if (digit && digit.match(/^[1-9]$/)) {
                fillCell(cell, digit);
            } else if (digit && digit !== null) {
                alert('‚ùå Veuillez entrer un chiffre entre 1 et 9');
            }
        }

        function fillCell(cell, digit) {
            if (cell.classList.contains('fixed')) return;

            const row = parseInt(cell.dataset.row);
            const col = parseInt(cell.dataset.col);
            
            const wasEmpty = sudokuGrid[row][col] === 0;
            
            cell.textContent = digit;
            cell.classList.remove('empty');
            cell.classList.add('filled');
            sudokuGrid[row][col] = parseInt(digit);
            
            if (wasEmpty) {
                completedCells++;
                mnistRecognitions++;
            }
            
            // Animation
            setTimeout(() => {
                cell.classList.remove('filled');
            }, 500);
            
            updateStats();
            checkWin();
        }

        function clearGrid() {
            if (confirm('üóëÔ∏è Voulez-vous vraiment effacer toutes les cellules modifiables ?')) {
                const cells = document.querySelectorAll('.sudoku-cell:not(.fixed)');
                cells.forEach(cell => {
                    const row = parseInt(cell.dataset.row);
                    const col = parseInt(cell.dataset.col);
                    
                    cell.textContent = '';
                    cell.innerHTML = '<span style="opacity:0.3; font-size:12px;">?</span>';
                    cell.classList.add('empty');
                    cell.classList.remove('selected');
                    sudokuGrid[row][col] = 0;
                });
                
                completedCells = countFixedCells();
                mnistRecognitions = 0;
                selectedCell = null;
                updateStats();
            }
        }

        function newGame() {
            if (confirm('üé≤ Commencer une nouvelle partie ?')) {
                // Ici tu pourrais charger une nouvelle grille
                initializeSudoku();
                mnistRecognitions = 0;
                updateStats();
            }
        }

        function validateSudoku() {
            let errors = [];
            
            // V√©rifier les lignes
            for (let row = 0; row < 9; row++) {
                const seen = new Set();
                for (let col = 0; col < 9; col++) {
                    const val = sudokuGrid[row][col];
                    if (val !== 0) {
                        if (seen.has(val)) {
                            errors.push(`Doublon ${val} dans la ligne ${row + 1}`);
                        }
                        seen.add(val);
                    }
                }
            }
            
            // V√©rifier les colonnes
            for (let col = 0; col < 9; col++) {
                const seen = new Set();
                for (let row = 0; row < 9; row++) {
                    const val = sudokuGrid[row][col];
                    if (val !== 0) {
                        if (seen.has(val)) {
                            errors.push(`Doublon ${val} dans la colonne ${col + 1}`);
                        }
                        seen.add(val);
                    }
                }
            }
            
            // V√©rifier les r√©gions 3x3
            for (let boxRow = 0; boxRow < 3; boxRow++) {
                for (let boxCol = 0; boxCol < 3; boxCol++) {
                    const seen = new Set();
                    for (let row = boxRow * 3; row < boxRow * 3 + 3; row++) {
                        for (let col = boxCol * 3; col < boxCol * 3 + 3; col++) {
                            const val = sudokuGrid[row][col];
                            if (val !== 0) {
                                if (seen.has(val)) {
                                    errors.push(`Doublon ${val} dans la r√©gion ${boxRow + 1}-${boxCol + 1}`);
                                }
                                seen.add(val);
                            }
                        }
                    }
                }
            }
            
            // Afficher le r√©sultat
            if (errors.length === 0) {
                const completed = completedCells === 81;
                if (completed) {
                    alert('üéâ F√©licitations ! Sudoku r√©solu parfaitement !');
                } else {
                    alert('‚úÖ Aucune erreur d√©tect√©e ! Continuez √† remplir...');
                }
            } else {
                alert('‚ùå Erreurs d√©tect√©es :\n\n' + errors.join('\n'));
            }
        }

        function checkWin() {
            if (completedCells === 81) {
                setTimeout(() => {
                    alert('üèÜ F√©licitations ! Vous avez termin√© le Sudoku !\n\n' +
                          `üìä Statistiques :\n` +
                          `‚Ä¢ Cellules remplies : ${completedCells}/81\n` +
                          `‚Ä¢ Reconnaissances MNIST : ${mnistRecognitions}\n` +
                          `‚Ä¢ Pr√©cision MNIST : 98.5%`);
                }, 1000);
            }
        }

        function updateStats() {
            document.getElementById('cellsCompleted').textContent = completedCells;
            document.getElementById('mnistUsed').textContent = mnistRecognitions;
            document.getElementById('gameProgress').textContent = Math.round((completedCells / 81) * 100) + '%';
        }

        function countFixedCells() {
            let count = 0;
            for (let row = 0; row < 9; row++) {
                for (let col = 0; col < 9; col++) {
                    if (initialGrid[row][col] !== 0) count++;
                }
            }
            return count;
        }

        function showInstructions() {
            document.getElementById('instructionsModal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('instructionsModal').style.display = 'none';
        }

        // Fermer la modal en cliquant √† l'ext√©rieur
        window.onclick = function(event) {
            const modal = document.getElementById('instructionsModal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }

        // Gestion du redimensionnement de l'iframe
        window.addEventListener('resize', function() {
            const iframe = document.getElementById('mnistFrame');
            if (window.innerWidth < 768) {
                iframe.style.height = '400px';
            } else {
                iframe.style.height = '500px';
            }
        });

        // Message d'accueil apr√®s chargement
        window.addEventListener('load', function() {
            setTimeout(() => {
                console.log('üéÆ App Sudoku + MNIST charg√©e !');
                console.log('üí° Utilisez la reconnaissance MNIST pour dessiner vos chiffres');
                console.log('üéØ Site UCSD int√©gr√© avec 98.5% de pr√©cision');
            }, 2000);
        });
    </script>
</body>
</html>
